function changeClass(e){_class=e;$("#cnh").html(classes[_class]);getCourses()}function getClasses(){for(id in classes){var e=$("#classItem").html();var t=e.format(++classId,classes[id]);$("#classes").append(t);$("#class-"+classId).attr("onclick","changeClass("+id+")")}}function getCourses(){deleted=0;nextId=0;$("#courses").html("");$.get("/timetable?class="+_class,function(e){courses=$.parseJSON(e);for(id in courses){addCourse(courses[id])}updateCourses()})}function getRemaining(e){var t=e-(new Date).getTime();var n=-1*Math.round(t/3e4);if(t<-3e6)return{when:"ended"};if(t<0)return{when:"Running",progress:n};if(t<36e5)return{when:Math.round(t/6e4)+" minutes"};return{when:Math.round(t/36e5)+" hours"}}function addCourse(e){if(e.cap)$("#courses").append("<h2>"+e.cap+"</h2>");var t=$("#listItem").html();var n=icons[e.type];var r=getRemaining(e.timestamp).when;e.extra="<b>"+e.room+" "+e.lec+"</b> ";var i=t.format(nextId++,e.name,e.start+"-"+e.end,e.extra+r,n);$("#courses").append(i);$("#course-item-"+(nextId-1)).attr("onclick",'$( "#left-panel" ).panel("close")')}function updateCourses(){for(var e in courses){var t=getRemaining(courses[e].timestamp);var n=+e+ +deleted;if(t.when==="ended"){getCourses();return;$("#course-item-"+e).remove();courses.shift();++deleted;continue}$("#list-extra-"+n).html(courses[e].extra+t.when);if(t.when==="Running"){var r=$("#progress-bar-"+n).progressbar();r.progressbar("value",t.progress)}}setTimeout(updateCourses,2e3)}var icons={LEC:"lec3.png",TUT:"tut.jpg",LAB:"lab2.png","?":"info.png"};var _class,deleted=0,classId=0,nextId=0,nextClass=0,defaultClass=4;var courses;$(document).ready(function(){getClasses();changeClass(defaultClass)});$(document).on("pagecreate","#demo-page",function(){$(document).on("swipeleft swiperight","#demo-page",function(e){if($(".ui-page-active").jqmData("panel")!=="open"){if(e.type==="swipeleft"){}else if(e.type==="swiperight"){$("#left-panel").panel("open")}}})});if(!String.prototype.format){String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,n){return typeof e[n]!="undefined"?e[n]:t})}}var classes=[];classes[1]="Computing 1";classes[2]="Computing 2";classes[3]="Computing 3";classes[4]="Computing 4";classes[5]="Electronic and Information Engineering 1";classes[6]="Electronic and Information Engineering 2";classes[7]="Electronic and Information Engineering 3";classes[8]="Electronic and Information Engineering 4";classes[18]="Electronic Engineering 3";classes[15]="Electronic Engineering 4";classes[9]="Joint Mathematics and Computer Science 1";classes[10]="Joint Mathematics and Computer Science 2";classes[11]="Joint Mathematics and Computer Science 3";classes[12]="Joint Mathematics and Computer Science 4";classes[17]="MCI";classes[28]="MRes in Advanced Computing";classes[14]="MSc Advanced Computing";classes[19]="MSc Computing";classes[13]="MSc Computing Science"